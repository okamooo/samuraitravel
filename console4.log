[2m2025-03-05T10:53:16.834+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:16.836+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:16.842+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/images/logo.png", parameters={}
[2m2025-03-05T10:53:16.842+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:16.842+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/storage/house02.jpg", parameters={}
[2m2025-03-05T10:53:16.843+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:16.843+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/js/flatpickr.js", parameters={}
[2m2025-03-05T10:53:16.843+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:16.847+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:16.851+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:16.857+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:26.363+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/houses/2/reservations/input?fromCheckinDateToCheckoutDate=2025-03-05+%E3%81%8B%E3%82%89+2025-03-06&numberOfPeople=3", parameters={masked}
[2m2025-03-05T10:53:26.364+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.ReservationController#input(Integer, ReservationInputForm, BindingResult, RedirectAttributes, Model)
[2m2025-03-05T10:53:26.379+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:26.390+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.web.servlet.view.RedirectView       [0;39m [2m:[0;39m View name [redirect:], model {}
[2m2025-03-05T10:53:26.390+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 302 FOUND
[2m2025-03-05T10:53:26.390+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/houses/2/reservations/confirm", parameters={}
[2m2025-03-05T10:53:26.390+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.ReservationController#confirm(Integer, ReservationInputForm, UserDetailsImpl, HttpServletRequest, Model)
[2m2025-03-05T10:53:26.390+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:26.893+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.w.s.v.ContentNegotiatingViewResolver[0;39m [2m:[0;39m Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
[2m2025-03-05T10:53:26.973+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:27.008+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/css/style.css", parameters={}
[2m2025-03-05T10:53:27.008+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:27.011+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:27.018+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/js/stripe.js", parameters={}
[2m2025-03-05T10:53:27.019+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-5] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/images/logo.png", parameters={}
[2m2025-03-05T10:53:27.019+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:27.020+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-5] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:27.024+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-5] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:27.042+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:42.378+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:53:42.378+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:53:42.378+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:53:42.378+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:53:42.382+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_3Qz79UBy52mpTfqU128Oh6Fu",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
[2m2025-03-05T10:53:42.382+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_3Qz79UBy52mpTfqU1pqz6brV",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
[2m2025-03-05T10:53:42.383+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-5] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:53:42.383+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-5] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:53:42.385+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-5] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_1Qz79VBy52mpTfqUBkmrXv7L",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
Received event: <com.stripe.model.Event@1783615602 id=evt_1Qz79VBy52mpTfqUBkmrXv7L> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139621,
  "data": {
    "previous_attributes": null,
    "object": {
      "id": "cs_test_a1aIGpvcckCl427k9RJkRDBBQ9MILqCoyImVzgsuK9bY5jzPIZGLmNyXBF",
      "object": "checkout.session",
      "adaptive_pricing": {
        "enabled": false
      },
      "after_expiration": null,
      "allow_promotion_codes": null,
      "amount_subtotal": 7000,
      "amount_total": 7000,
      "automatic_tax": {
        "enabled": false,
        "liability": null,
        "status": null
      },
      "billing_address_collection": null,
      "cancel_url": "http://localhost:8080/houses/2",
      "client_reference_id": null,
      "client_secret": null,
      "collected_information": null,
      "consent": null,
      "consent_collection": null,
      "created": 1741139605,
      "currency": "jpy",
      "currency_conversion": null,
      "custom_fields": [],
      "custom_text": {
        "after_submit": null,
        "shipping_address": null,
        "submit": null,
        "terms_of_service_acceptance": null
      },
      "customer": null,
      "customer_creation": "if_required",
      "customer_details": {
        "address": {
          "city": null,
          "country": "JP",
          "line1": null,
          "line2": null,
          "postal_code": null,
          "state": null
        },
        "email": "taro.samurai@example.com",
        "name": "Taro Samurai",
        "phone": null,
        "tax_exempt": "none",
        "tax_ids": []
      },
      "customer_email": null,
      "discounts": [],
      "expires_at": 1741226005,
      "invoice": null,
      "invoice_creation": {
        "enabled": false,
        "invoice_data": {
          "account_tax_ids": null,
          "custom_fields": null,
          "description": null,
          "footer": null,
          "issuer": null,
          "metadata": {},
          "rendering_options": null
        }
      },
      "livemode": false,
      "locale": null,
      "metadata": {},
      "mode": "payment",
      "payment_intent": "pi_3Qz79UBy52mpTfqU1qCAOiTd",
      "payment_link": null,
      "payment_method_collection": "if_required",
      "payment_method_configuration_details": null,
      "payment_method_options": {
        "card": {
          "request_three_d_secure": "automatic"
        }
      },
      "payment_method_types": [
        "card"
      ],
      "payment_status": "paid",
      "phone_number_collection": {
        "enabled": false
      },
      "recovered_from": null,
      "saved_payment_method_options": null,
      "setup_intent": null,
      "shipping_address_collection": null,
      "shipping_cost": null,
      "shipping_options": [],
      "status": "complete",
      "submit_type": null,
      "subscription": null,
      "success_url": "http://localhost:8080/reservations?reserved",
      "total_details": {
        "amount_discount": 0,
        "amount_shipping": 0,
        "amount_tax": 0
      },
      "ui_mode": "hosted",
      "url": null
    }
  },
  "id": "evt_1Qz79VBy52mpTfqUBkmrXv7L",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": null,
    "idempotency_key": null
  },
  "type": "checkout.session.completed"
}
Received event: <com.stripe.model.Event@2006523868 id=evt_3Qz79UBy52mpTfqU128Oh6Fu> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139621,
  "data": {
    "previous_attributes": null,
    "object": {
      "id": "pi_3Qz79UBy52mpTfqU1qCAOiTd",
      "object": "payment_intent",
      "amount": 7000,
      "amount_capturable": 0,
      "amount_details": {
        "tip": {}
      },
      "amount_received": 7000,
      "application": null,
      "application_fee_amount": null,
      "automatic_payment_methods": null,
      "canceled_at": null,
      "cancellation_reason": null,
      "capture_method": "automatic_async",
      "client_secret": "pi_3Qz79UBy52mpTfqU1qCAOiTd_secret_b0zIdlEIqtxdDmvGA06PG0fAG",
      "confirmation_method": "automatic",
      "created": 1741139620,
      "currency": "jpy",
      "customer": null,
      "description": null,
      "invoice": null,
      "last_payment_error": null,
      "latest_charge": "ch_3Qz79UBy52mpTfqU1Hll90Dr",
      "livemode": false,
      "metadata": {
        "checkoutDate": "2025-03-06",
        "checkinDate": "2025-03-05",
        "houseId": "2",
        "userId": "1",
        "numberOfPeople": "3",
        "amount": "7000"
      },
      "next_action": null,
      "on_behalf_of": null,
      "payment_method": "pm_1Qz79TBy52mpTfqUug1eFIng",
      "payment_method_configuration_details": null,
      "payment_method_options": {
        "card": {
          "installments": null,
          "mandate_options": null,
          "network": null,
          "request_three_d_secure": "automatic"
        }
      },
      "payment_method_types": [
        "card"
      ],
      "processing": null,
      "receipt_email": null,
      "review": null,
      "setup_future_usage": null,
      "shipping": null,
      "source": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "succeeded",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "id": "evt_3Qz79UBy52mpTfqU128Oh6Fu",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": "req_O7qeRjSjkCE6CA",
    "idempotency_key": "01bb8871-d32e-40a0-a8cf-c6a0f26aaf17"
  },
  "type": "payment_intent.succeeded"
}
Received event: <com.stripe.model.Event@1469325350 id=evt_3Qz79UBy52mpTfqU1pqz6brV> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139620,
  "data": {
    "previous_attributes": null,
    "object": {
      "id": "ch_3Qz79UBy52mpTfqU1Hll90Dr",
      "object": "charge",
      "amount": 7000,
      "amount_captured": 7000,
      "amount_refunded": 0,
      "application": null,
      "application_fee": null,
      "application_fee_amount": null,
      "balance_transaction": null,
      "billing_details": {
        "address": {
          "city": null,
          "country": "JP",
          "line1": null,
          "line2": null,
          "postal_code": null,
          "state": null
        },
        "email": "taro.samurai@example.com",
        "name": "Taro Samurai",
        "phone": null
      },
      "calculated_statement_descriptor": "Stripe",
      "captured": true,
      "created": 1741139620,
      "currency": "jpy",
      "customer": null,
      "description": null,
      "destination": null,
      "dispute": null,
      "disputed": false,
      "failure_balance_transaction": null,
      "failure_code": null,
      "failure_message": null,
      "fraud_details": {},
      "invoice": null,
      "livemode": false,
      "metadata": {
        "checkoutDate": "2025-03-06",
        "checkinDate": "2025-03-05",
        "houseId": "2",
        "userId": "1",
        "numberOfPeople": "3",
        "amount": "7000"
      },
      "on_behalf_of": null,
      "order": null,
      "outcome": {
        "advice_code": null,
        "network_advice_code": null,
        "network_decline_code": null,
        "network_status": "approved_by_network",
        "reason": null,
        "risk_level": "normal",
        "risk_score": 19,
        "seller_message": "Payment complete.",
        "type": "authorized"
      },
      "paid": true,
      "payment_intent": "pi_3Qz79UBy52mpTfqU1qCAOiTd",
      "payment_method": "pm_1Qz79TBy52mpTfqUug1eFIng",
      "payment_method_details": {
        "card": {
          "amount_authorized": 7000,
          "authorization_code": null,
          "brand": "visa",
          "checks": {
            "address_line1_check": null,
            "address_postal_code_check": null,
            "cvc_check": "pass"
          },
          "country": "US",
          "exp_month": 12,
          "exp_year": 2050,
          "extended_authorization": {
            "status": "disabled"
          },
          "fingerprint": "4IIc4cziskO6T53s",
          "funding": "credit",
          "incremental_authorization": {
            "status": "unavailable"
          },
          "installments": null,
          "last4": "4242",
          "mandate": null,
          "multicapture": {
            "status": "unavailable"
          },
          "network": "visa",
          "network_token": {
            "used": false
          },
          "network_transaction_id": "527373995299122",
          "overcapture": {
            "maximum_amount_capturable": 7000,
            "status": "unavailable"
          },
          "regulated_status": "unregulated",
          "three_d_secure": null,
          "wallet": null
        },
        "type": "card"
      },
      "radar_options": {},
      "receipt_email": null,
      "receipt_number": null,
      "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUXgxVjhCeTUybXBUZnFVKKXdnr4GMgaxNLJuVNU6LBYsOvObwTfxB2wcvojudlYcPk_v4AdqhJ5lwvRNZF6KvaNekO0WF3Ne-Oo_",
      "refunded": false,
      "review": null,
      "shipping": null,
      "source": null,
      "source_transfer": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "succeeded",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "id": "evt_3Qz79UBy52mpTfqU1pqz6brV",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": "req_O7qeRjSjkCE6CA",
    "idempotency_key": "01bb8871-d32e-40a0-a8cf-c6a0f26aaf17"
  },
  "type": "charge.succeeded"
}
[2m2025-03-05T10:53:42.394+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Using 'application/xml', given [application/xml, */*;q=0.5] and supported [text/plain, */*, application/json, application/*+json]
[2m2025-03-05T10:53:42.394+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Using 'application/xml', given [application/xml, */*;q=0.5] and supported [text/plain, */*, application/json, application/*+json]
[2m2025-03-05T10:53:42.404+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Writing ["Success"]
[2m2025-03-05T10:53:42.404+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Writing ["Success"]
[2m2025-03-05T10:53:42.420+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:42.420+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:42.435+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:53:42.435+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:53:42.435+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_3Qz79UBy52mpTfqU1fp01Job",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
Received event: <com.stripe.model.Event@1543355181 id=evt_3Qz79UBy52mpTfqU1fp01Job> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139620,
  "data": {
    "previous_attributes": null,
    "object": {
      "id": "pi_3Qz79UBy52mpTfqU1qCAOiTd",
      "object": "payment_intent",
      "amount": 7000,
      "amount_capturable": 0,
      "amount_details": {
        "tip": {}
      },
      "amount_received": 0,
      "application": null,
      "application_fee_amount": null,
      "automatic_payment_methods": null,
      "canceled_at": null,
      "cancellation_reason": null,
      "capture_method": "automatic_async",
      "client_secret": "pi_3Qz79UBy52mpTfqU1qCAOiTd_secret_b0zIdlEIqtxdDmvGA06PG0fAG",
      "confirmation_method": "automatic",
      "created": 1741139620,
      "currency": "jpy",
      "customer": null,
      "description": null,
      "invoice": null,
      "last_payment_error": null,
      "latest_charge": null,
      "livemode": false,
      "metadata": {
        "checkoutDate": "2025-03-06",
        "checkinDate": "2025-03-05",
        "houseId": "2",
        "userId": "1",
        "numberOfPeople": "3",
        "amount": "7000"
      },
      "next_action": null,
      "on_behalf_of": null,
      "payment_method": null,
      "payment_method_configuration_details": null,
      "payment_method_options": {
        "card": {
          "installments": null,
          "mandate_options": null,
          "network": null,
          "request_three_d_secure": "automatic"
        }
      },
      "payment_method_types": [
        "card"
      ],
      "processing": null,
      "receipt_email": null,
      "review": null,
      "setup_future_usage": null,
      "shipping": null,
      "source": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "requires_payment_method",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "id": "evt_3Qz79UBy52mpTfqU1fp01Job",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": "req_O7qeRjSjkCE6CA",
    "idempotency_key": "01bb8871-d32e-40a0-a8cf-c6a0f26aaf17"
  },
  "type": "payment_intent.created"
}
[2m2025-03-05T10:53:42.435+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Using 'application/xml', given [application/xml, */*;q=0.5] and supported [text/plain, */*, application/json, application/*+json]
[2m2025-03-05T10:53:42.435+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Writing ["Success"]
[2m2025-03-05T10:53:42.438+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:44.195+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/reservations?reserved", parameters={masked}
[2m2025-03-05T10:53:44.195+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.ReservationController#index(UserDetailsImpl, Pageable, Model)
[2m2025-03-05T10:53:44.200+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select r1_0.id,r1_0.amount,r1_0.checkin_date,r1_0.checkout_date,r1_0.created_at,r1_0.house_id,r1_0.number_of_people,r1_0.updated_at,r1_0.user_id from reservations r1_0 where r1_0.user_id=? order by r1_0.created_at desc,r1_0.id limit ?
[2m2025-03-05T10:53:44.212+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.214+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select u1_0.id,u1_0.address,u1_0.created_at,u1_0.email,u1_0.enabled,u1_0.furigana,u1_0.name,u1_0.password,u1_0.phone_number,u1_0.postal_code,r1_0.id,r1_0.name,u1_0.updated_at from users u1_0 left join roles r1_0 on r1_0.id=u1_0.role_id where u1_0.id=?
[2m2025-03-05T10:53:44.217+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.220+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.222+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.225+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.227+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.229+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.231+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.232+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:53:44.235+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select count(r1_0.id) from reservations r1_0 where r1_0.user_id=?
[2m2025-03-05T10:53:44.249+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.w.s.v.ContentNegotiatingViewResolver[0;39m [2m:[0;39m Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
[2m2025-03-05T10:53:44.285+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:44.355+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/css/style.css", parameters={}
[2m2025-03-05T10:53:44.355+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/images/logo.png", parameters={}
[2m2025-03-05T10:53:44.358+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:44.358+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:53:44.362+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:44.362+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:53:44.467+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:53:44.468+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:53:44.469+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_3Qz79UBy52mpTfqU115jpMte",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
Received event: <com.stripe.model.Event@1586244539 id=evt_3Qz79UBy52mpTfqU115jpMte> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139623,
  "data": {
    "previous_attributes": {
      "balance_transaction": null,
      "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUXgxVjhCeTUybXBUZnFVKKfdnr4GMgaMCLPeRV46LBYreNV76AD8leGoZ7FbTBUBqj5rIU12TT0Q0gD0ME5VecW2IZwBMLiT8Avt"
    },
    "object": {
      "id": "ch_3Qz79UBy52mpTfqU1Hll90Dr",
      "object": "charge",
      "amount": 7000,
      "amount_captured": 7000,
      "amount_refunded": 0,
      "application": null,
      "application_fee": null,
      "application_fee_amount": null,
      "balance_transaction": "txn_3Qz79UBy52mpTfqU1RDvd6V6",
      "billing_details": {
        "address": {
          "city": null,
          "country": "JP",
          "line1": null,
          "line2": null,
          "postal_code": null,
          "state": null
        },
        "email": "taro.samurai@example.com",
        "name": "Taro Samurai",
        "phone": null
      },
      "calculated_statement_descriptor": "Stripe",
      "captured": true,
      "created": 1741139620,
      "currency": "jpy",
      "customer": null,
      "description": null,
      "destination": null,
      "dispute": null,
      "disputed": false,
      "failure_balance_transaction": null,
      "failure_code": null,
      "failure_message": null,
      "fraud_details": {},
      "invoice": null,
      "livemode": false,
      "metadata": {
        "checkoutDate": "2025-03-06",
        "checkinDate": "2025-03-05",
        "houseId": "2",
        "userId": "1",
        "numberOfPeople": "3",
        "amount": "7000"
      },
      "on_behalf_of": null,
      "order": null,
      "outcome": {
        "advice_code": null,
        "network_advice_code": null,
        "network_decline_code": null,
        "network_status": "approved_by_network",
        "reason": null,
        "risk_level": "normal",
        "risk_score": 19,
        "seller_message": "Payment complete.",
        "type": "authorized"
      },
      "paid": true,
      "payment_intent": "pi_3Qz79UBy52mpTfqU1qCAOiTd",
      "payment_method": "pm_1Qz79TBy52mpTfqUug1eFIng",
      "payment_method_details": {
        "card": {
          "amount_authorized": 7000,
          "authorization_code": null,
          "brand": "visa",
          "checks": {
            "address_line1_check": null,
            "address_postal_code_check": null,
            "cvc_check": "pass"
          },
          "country": "US",
          "exp_month": 12,
          "exp_year": 2050,
          "extended_authorization": {
            "status": "disabled"
          },
          "fingerprint": "4IIc4cziskO6T53s",
          "funding": "credit",
          "incremental_authorization": {
            "status": "unavailable"
          },
          "installments": null,
          "last4": "4242",
          "mandate": null,
          "multicapture": {
            "status": "unavailable"
          },
          "network": "visa",
          "network_token": {
            "used": false
          },
          "network_transaction_id": "527373995299122",
          "overcapture": {
            "maximum_amount_capturable": 7000,
            "status": "unavailable"
          },
          "regulated_status": "unregulated",
          "three_d_secure": null,
          "wallet": null
        },
        "type": "card"
      },
      "radar_options": {},
      "receipt_email": null,
      "receipt_number": null,
      "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUXgxVjhCeTUybXBUZnFVKKfdnr4GMgahVm7VmWg6LBYYe9q7VyJpR9M1ugRnlp9Qek7rX6bCiPQJTnJDYlbEnU5fJP_dzrJ5x3KF",
      "refunded": false,
      "review": null,
      "shipping": null,
      "source": null,
      "source_transfer": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "succeeded",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "id": "evt_3Qz79UBy52mpTfqU115jpMte",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": null,
    "idempotency_key": null
  },
  "type": "charge.updated"
}
[2m2025-03-05T10:53:44.469+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Using 'application/xml', given [application/xml, */*;q=0.5] and supported [text/plain, */*, application/json, application/*+json]
[2m2025-03-05T10:53:44.469+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Writing ["Success"]
[2m2025-03-05T10:53:44.473+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:07.373+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/houses/2", parameters={}
[2m2025-03-05T10:57:07.373+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.HouseController#show(Integer, Model)
[2m2025-03-05T10:57:07.376+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.w.s.v.ContentNegotiatingViewResolver[0;39m [2m:[0;39m Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
[2m2025-03-05T10:57:07.385+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:07.396+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:07.425+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/css/style.css", parameters={}
[2m2025-03-05T10:57:07.425+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:07.428+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:07.438+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/images/logo.png", parameters={}
[2m2025-03-05T10:57:07.438+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/storage/house02.jpg", parameters={}
[2m2025-03-05T10:57:07.438+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:07.438+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:07.442+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:07.442+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/js/flatpickr.js", parameters={}
[2m2025-03-05T10:57:07.442+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:07.444+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-7] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:07.450+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:15.129+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/houses/2/reservations/input?fromCheckinDateToCheckoutDate=2025-03-05+%E3%81%8B%E3%82%89+2025-03-06&numberOfPeople=3", parameters={masked}
[2m2025-03-05T10:57:15.129+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.ReservationController#input(Integer, ReservationInputForm, BindingResult, RedirectAttributes, Model)
[2m2025-03-05T10:57:15.149+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:15.150+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36mo.s.web.servlet.view.RedirectView       [0;39m [2m:[0;39m View name [redirect:], model {}
[2m2025-03-05T10:57:15.150+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 302 FOUND
[2m2025-03-05T10:57:15.150+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/houses/2/reservations/confirm", parameters={}
[2m2025-03-05T10:57:15.150+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.ReservationController#confirm(Integer, ReservationInputForm, UserDetailsImpl, HttpServletRequest, Model)
[2m2025-03-05T10:57:15.161+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:15.627+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.w.s.v.ContentNegotiatingViewResolver[0;39m [2m:[0;39m Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
[2m2025-03-05T10:57:15.645+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:15.688+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/css/style.css", parameters={}
[2m2025-03-05T10:57:15.688+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:15.690+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:15.692+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/images/logo.png", parameters={}
[2m2025-03-05T10:57:15.692+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:15.692+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/js/stripe.js", parameters={}
[2m2025-03-05T10:57:15.692+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:15.696+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:15.696+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:34.775+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:57:34.776+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:57:34.778+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_3Qz7DEBy52mpTfqU14HvW5xf",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
[2m2025-03-05T10:57:34.781+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:57:34.783+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:57:34.784+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-6] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_1Qz7DFBy52mpTfqUaCO3KlvJ",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
Received event: <com.stripe.model.Event@892880611 id=evt_3Qz7DEBy52mpTfqU14HvW5xf> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139853,
  "data": {
    "previous_attributes": null,
    "object": {
      "id": "ch_3Qz7DEBy52mpTfqU193wQuf7",
      "object": "charge",
      "amount": 7000,
      "amount_captured": 7000,
      "amount_refunded": 0,
      "application": null,
      "application_fee": null,
      "application_fee_amount": null,
      "balance_transaction": null,
      "billing_details": {
        "address": {
          "city": null,
          "country": "JP",
          "line1": null,
          "line2": null,
          "postal_code": null,
          "state": null
        },
        "email": "taro.samurai@example.com",
        "name": "Taro Samurai",
        "phone": null
      },
      "calculated_statement_descriptor": "Stripe",
      "captured": true,
      "created": 1741139853,
      "currency": "jpy",
      "customer": null,
      "description": null,
      "destination": null,
      "dispute": null,
      "disputed": false,
      "failure_balance_transaction": null,
      "failure_code": null,
      "failure_message": null,
      "fraud_details": {},
      "invoice": null,
      "livemode": false,
      "metadata": {
        "checkoutDate": "2025-03-06",
        "checkinDate": "2025-03-05",
        "houseId": "2",
        "userId": "1",
        "numberOfPeople": "3",
        "amount": "7000"
      },
      "on_behalf_of": null,
      "order": null,
      "outcome": {
        "advice_code": null,
        "network_advice_code": null,
        "network_decline_code": null,
        "network_status": "approved_by_network",
        "reason": null,
        "risk_level": "normal",
        "risk_score": 46,
        "seller_message": "Payment complete.",
        "type": "authorized"
      },
      "paid": true,
      "payment_intent": "pi_3Qz7DEBy52mpTfqU1r8cZjrT",
      "payment_method": "pm_1Qz7DEBy52mpTfqUuiDr8bvK",
      "payment_method_details": {
        "card": {
          "amount_authorized": 7000,
          "authorization_code": null,
          "brand": "visa",
          "checks": {
            "address_line1_check": null,
            "address_postal_code_check": null,
            "cvc_check": "pass"
          },
          "country": "US",
          "exp_month": 12,
          "exp_year": 2050,
          "extended_authorization": {
            "status": "disabled"
          },
          "fingerprint": "4IIc4cziskO6T53s",
          "funding": "credit",
          "incremental_authorization": {
            "status": "unavailable"
          },
          "installments": null,
          "last4": "4242",
          "mandate": null,
          "multicapture": {
            "status": "unavailable"
          },
          "network": "visa",
          "network_token": {
            "used": false
          },
          "network_transaction_id": "527373995299122",
          "overcapture": {
            "maximum_amount_capturable": 7000,
            "status": "unavailable"
          },
          "regulated_status": "unregulated",
          "three_d_secure": null,
          "wallet": null
        },
        "type": "card"
      },
      "radar_options": {},
      "receipt_email": null,
      "receipt_number": null,
      "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUXgxVjhCeTUybXBUZnFVKI3fnr4GMgZCp2mIib86LBb7CiCXBKT3r4R-kZyxfB9ARcnQ0j3gLeB_ns2KjjUmf5ctinTqMSdw0Shv",
      "refunded": false,
      "review": null,
      "shipping": null,
      "source": null,
      "source_transfer": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "succeeded",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "id": "evt_3Qz7DEBy52mpTfqU14HvW5xf",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": "req_Qf4oTQjSsO8IJB",
    "idempotency_key": "15b4db22-082c-45db-b179-3478fcdcbfd4"
  },
  "type": "charge.succeeded"
}
[2m2025-03-05T10:57:34.786+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Using 'application/xml', given [application/xml, */*;q=0.5] and supported [text/plain, */*, application/json, application/*+json]
[2m2025-03-05T10:57:34.788+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Writing ["Success"]
Received event: <com.stripe.model.Event@372682264 id=evt_1Qz7DFBy52mpTfqUaCO3KlvJ> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139853,
  "data": {
    "previous_attributes": null,
    "object": {
      "id": "cs_test_a1tDL5G4iVNK40ywaBEx7sAetl8hj4MB13Gfg07Mm0obMiZ6Tcn0t3WK1h",
      "object": "checkout.session",
      "adaptive_pricing": {
        "enabled": false
      },
      "after_expiration": null,
      "allow_promotion_codes": null,
      "amount_subtotal": 7000,
      "amount_total": 7000,
      "automatic_tax": {
        "enabled": false,
        "liability": null,
        "status": null
      },
      "billing_address_collection": null,
      "cancel_url": "http://localhost:8080/houses/2",
      "client_reference_id": null,
      "client_secret": null,
      "collected_information": null,
      "consent": null,
      "consent_collection": null,
      "created": 1741139834,
      "currency": "jpy",
      "currency_conversion": null,
      "custom_fields": [],
      "custom_text": {
        "after_submit": null,
        "shipping_address": null,
        "submit": null,
        "terms_of_service_acceptance": null
      },
      "customer": null,
      "customer_creation": "if_required",
      "customer_details": {
        "address": {
          "city": null,
          "country": "JP",
          "line1": null,
          "line2": null,
          "postal_code": null,
          "state": null
        },
        "email": "taro.samurai@example.com",
        "name": "Taro Samurai",
        "phone": null,
        "tax_exempt": "none",
        "tax_ids": []
      },
      "customer_email": null,
      "discounts": [],
      "expires_at": 1741226234,
      "invoice": null,
      "invoice_creation": {
        "enabled": false,
        "invoice_data": {
          "account_tax_ids": null,
          "custom_fields": null,
          "description": null,
          "footer": null,
          "issuer": null,
          "metadata": {},
          "rendering_options": null
        }
      },
      "livemode": false,
      "locale": null,
      "metadata": {},
      "mode": "payment",
      "payment_intent": "pi_3Qz7DEBy52mpTfqU1r8cZjrT",
      "payment_link": null,
      "payment_method_collection": "if_required",
      "payment_method_configuration_details": null,
      "payment_method_options": {
        "card": {
          "request_three_d_secure": "automatic"
        }
      },
      "payment_method_types": [
        "card"
      ],
      "payment_status": "paid",
      "phone_number_collection": {
        "enabled": false
      },
      "recovered_from": null,
      "saved_payment_method_options": null,
      "setup_intent": null,
      "shipping_address_collection": null,
      "shipping_cost": null,
      "shipping_options": [],
      "status": "complete",
      "submit_type": null,
      "subscription": null,
      "success_url": "http://localhost:8080/reservations?reserved",
      "total_details": {
        "amount_discount": 0,
        "amount_shipping": 0,
        "amount_tax": 0
      },
      "ui_mode": "hosted",
      "url": null
    }
  },
  "id": "evt_1Qz7DFBy52mpTfqUaCO3KlvJ",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": null,
    "idempotency_key": null
  },
  "type": "checkout.session.completed"
}
[2m2025-03-05T10:57:34.789+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-9] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:34.852+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:57:34.852+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:57:34.852+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_3Qz7DEBy52mpTfqU1hKV0TGP",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
Received event: <com.stripe.model.Event@122202553 id=evt_3Qz7DEBy52mpTfqU1hKV0TGP> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139853,
  "data": {
    "previous_attributes": null,
    "object": {
      "id": "pi_3Qz7DEBy52mpTfqU1r8cZjrT",
      "object": "payment_intent",
      "amount": 7000,
      "amount_capturable": 0,
      "amount_details": {
        "tip": {}
      },
      "amount_received": 7000,
      "application": null,
      "application_fee_amount": null,
      "automatic_payment_methods": null,
      "canceled_at": null,
      "cancellation_reason": null,
      "capture_method": "automatic_async",
      "client_secret": "pi_3Qz7DEBy52mpTfqU1r8cZjrT_secret_kX5NowpCvWEEsUQJkOtxmqANb",
      "confirmation_method": "automatic",
      "created": 1741139852,
      "currency": "jpy",
      "customer": null,
      "description": null,
      "invoice": null,
      "last_payment_error": null,
      "latest_charge": "ch_3Qz7DEBy52mpTfqU193wQuf7",
      "livemode": false,
      "metadata": {
        "checkoutDate": "2025-03-06",
        "checkinDate": "2025-03-05",
        "houseId": "2",
        "userId": "1",
        "numberOfPeople": "3",
        "amount": "7000"
      },
      "next_action": null,
      "on_behalf_of": null,
      "payment_method": "pm_1Qz7DEBy52mpTfqUuiDr8bvK",
      "payment_method_configuration_details": null,
      "payment_method_options": {
        "card": {
          "installments": null,
          "mandate_options": null,
          "network": null,
          "request_three_d_secure": "automatic"
        }
      },
      "payment_method_types": [
        "card"
      ],
      "processing": null,
      "receipt_email": null,
      "review": null,
      "setup_future_usage": null,
      "shipping": null,
      "source": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "succeeded",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "id": "evt_3Qz7DEBy52mpTfqU1hKV0TGP",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": "req_Qf4oTQjSsO8IJB",
    "idempotency_key": "15b4db22-082c-45db-b179-3478fcdcbfd4"
  },
  "type": "payment_intent.succeeded"
}
[2m2025-03-05T10:57:34.852+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Using 'application/xml', given [application/xml, */*;q=0.5] and supported [text/plain, */*, application/json, application/*+json]
[2m2025-03-05T10:57:34.852+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Writing ["Success"]
[2m2025-03-05T10:57:34.854+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-8] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:34.868+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:57:34.868+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:57:34.868+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_3Qz7DEBy52mpTfqU1OQUF79e",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
Received event: <com.stripe.model.Event@231632653 id=evt_3Qz7DEBy52mpTfqU1OQUF79e> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139852,
  "data": {
    "previous_attributes": null,
    "object": {
      "id": "pi_3Qz7DEBy52mpTfqU1r8cZjrT",
      "object": "payment_intent",
      "amount": 7000,
      "amount_capturable": 0,
      "amount_details": {
        "tip": {}
      },
      "amount_received": 0,
      "application": null,
      "application_fee_amount": null,
      "automatic_payment_methods": null,
      "canceled_at": null,
      "cancellation_reason": null,
      "capture_method": "automatic_async",
      "client_secret": "pi_3Qz7DEBy52mpTfqU1r8cZjrT_secret_kX5NowpCvWEEsUQJkOtxmqANb",
      "confirmation_method": "automatic",
      "created": 1741139852,
      "currency": "jpy",
      "customer": null,
      "description": null,
      "invoice": null,
      "last_payment_error": null,
      "latest_charge": null,
      "livemode": false,
      "metadata": {
        "checkoutDate": "2025-03-06",
        "checkinDate": "2025-03-05",
        "houseId": "2",
        "userId": "1",
        "numberOfPeople": "3",
        "amount": "7000"
      },
      "next_action": null,
      "on_behalf_of": null,
      "payment_method": null,
      "payment_method_configuration_details": null,
      "payment_method_options": {
        "card": {
          "installments": null,
          "mandate_options": null,
          "network": null,
          "request_three_d_secure": "automatic"
        }
      },
      "payment_method_types": [
        "card"
      ],
      "processing": null,
      "receipt_email": null,
      "review": null,
      "setup_future_usage": null,
      "shipping": null,
      "source": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "requires_payment_method",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "id": "evt_3Qz7DEBy52mpTfqU1OQUF79e",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": "req_Qf4oTQjSsO8IJB",
    "idempotency_key": "15b4db22-082c-45db-b179-3478fcdcbfd4"
  },
  "type": "payment_intent.created"
}
[2m2025-03-05T10:57:34.868+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Using 'application/xml', given [application/xml, */*;q=0.5] and supported [text/plain, */*, application/json, application/*+json]
[2m2025-03-05T10:57:34.868+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Writing ["Success"]
[2m2025-03-05T10:57:34.870+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-4] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:36.624+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/reservations?reserved", parameters={masked}
[2m2025-03-05T10:57:36.624+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.ReservationController#index(UserDetailsImpl, Pageable, Model)
[2m2025-03-05T10:57:36.633+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select r1_0.id,r1_0.amount,r1_0.checkin_date,r1_0.checkout_date,r1_0.created_at,r1_0.house_id,r1_0.number_of_people,r1_0.updated_at,r1_0.user_id from reservations r1_0 where r1_0.user_id=? order by r1_0.created_at desc,r1_0.id limit ?
[2m2025-03-05T10:57:36.633+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.633+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select u1_0.id,u1_0.address,u1_0.created_at,u1_0.email,u1_0.enabled,u1_0.furigana,u1_0.name,u1_0.password,u1_0.phone_number,u1_0.postal_code,r1_0.id,r1_0.name,u1_0.updated_at from users u1_0 left join roles r1_0 on r1_0.id=u1_0.role_id where u1_0.id=?
[2m2025-03-05T10:57:36.640+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.642+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.647+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.650+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.652+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.655+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.657+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.659+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select h1_0.id,h1_0.address,h1_0.capacity,h1_0.created_at,h1_0.description,h1_0.image_name,h1_0.name,h1_0.phone_number,h1_0.postal_code,h1_0.price,h1_0.updated_at from houses h1_0 where h1_0.id=?
[2m2025-03-05T10:57:36.661+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36morg.hibernate.SQL                       [0;39m [2m:[0;39m select count(r1_0.id) from reservations r1_0 where r1_0.user_id=?
[2m2025-03-05T10:57:36.665+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.w.s.v.ContentNegotiatingViewResolver[0;39m [2m:[0;39m Selected 'text/html' given [text/html, application/xhtml+xml, image/avif, image/webp, image/apng, application/xml;q=0.9, */*;q=0.8, application/signed-exchange;v=b3;q=0.7]
[2m2025-03-05T10:57:36.824+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-2] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:36.860+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m POST "/stripe/webhook", parameters={}
[2m2025-03-05T10:57:36.860+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36ms.w.s.m.m.a.RequestMappingHandlerMapping[0;39m [2m:[0;39m Mapped to com.example.samuraitravel.controller.StripeWebhookController#webhook(String, String)
[2m2025-03-05T10:57:36.860+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mm.m.a.RequestResponseBodyMethodProcessor[0;39m [2m:[0;39m Read "application/json;charset=utf-8" to ["{<EOL>  "id": "evt_3Qz7DEBy52mpTfqU11yXtOyX",<EOL>  "object": "event",<EOL>  "api_version": "2025-02-24.acacia", (truncated)..."]
Received event: <com.stripe.model.Event@417468745 id=evt_3Qz7DEBy52mpTfqU11yXtOyX> JSON: {
  "account": null,
  "api_version": "2025-02-24.acacia",
  "created": 1741139855,
  "data": {
    "previous_attributes": {
      "balance_transaction": null,
      "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUXgxVjhCeTUybXBUZnFVKI_fnr4GMgbRQGsqZcA6LBbNEjnADrlGSMfyuUzgEcS_1TYTEkvuMz5MkPqFyPDp8hBfeXhTTNz7C16d"
    },
    "object": {
      "id": "ch_3Qz7DEBy52mpTfqU193wQuf7",
      "object": "charge",
      "amount": 7000,
      "amount_captured": 7000,
      "amount_refunded": 0,
      "application": null,
      "application_fee": null,
      "application_fee_amount": null,
      "balance_transaction": "txn_3Qz7DEBy52mpTfqU1crUvJez",
      "billing_details": {
        "address": {
          "city": null,
          "country": "JP",
          "line1": null,
          "line2": null,
          "postal_code": null,
          "state": null
        },
        "email": "taro.samurai@example.com",
        "name": "Taro Samurai",
        "phone": null
      },
      "calculated_statement_descriptor": "Stripe",
      "captured": true,
      "created": 1741139853,
      "currency": "jpy",
      "customer": null,
      "description": null,
      "destination": null,
      "dispute": null,
      "disputed": false,
      "failure_balance_transaction": null,
      "failure_code": null,
      "failure_message": null,
      "fraud_details": {},
      "invoice": null,
      "livemode": false,
      "metadata": {
        "checkoutDate": "2025-03-06",
        "checkinDate": "2025-03-05",
        "houseId": "2",
        "userId": "1",
        "numberOfPeople": "3",
        "amount": "7000"
      },
      "on_behalf_of": null,
      "order": null,
      "outcome": {
        "advice_code": null,
        "network_advice_code": null,
        "network_decline_code": null,
        "network_status": "approved_by_network",
        "reason": null,
        "risk_level": "normal",
        "risk_score": 46,
        "seller_message": "Payment complete.",
        "type": "authorized"
      },
      "paid": true,
      "payment_intent": "pi_3Qz7DEBy52mpTfqU1r8cZjrT",
      "payment_method": "pm_1Qz7DEBy52mpTfqUuiDr8bvK",
      "payment_method_details": {
        "card": {
          "amount_authorized": 7000,
          "authorization_code": null,
          "brand": "visa",
          "checks": {
            "address_line1_check": null,
            "address_postal_code_check": null,
            "cvc_check": "pass"
          },
          "country": "US",
          "exp_month": 12,
          "exp_year": 2050,
          "extended_authorization": {
            "status": "disabled"
          },
          "fingerprint": "4IIc4cziskO6T53s",
          "funding": "credit",
          "incremental_authorization": {
            "status": "unavailable"
          },
          "installments": null,
          "last4": "4242",
          "mandate": null,
          "multicapture": {
            "status": "unavailable"
          },
          "network": "visa",
          "network_token": {
            "used": false
          },
          "network_transaction_id": "527373995299122",
          "overcapture": {
            "maximum_amount_capturable": 7000,
            "status": "unavailable"
          },
          "regulated_status": "unregulated",
          "three_d_secure": null,
          "wallet": null
        },
        "type": "card"
      },
      "radar_options": {},
      "receipt_email": null,
      "receipt_number": null,
      "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUXgxVjhCeTUybXBUZnFVKI_fnr4GMgZQ6fstYI06LBbzNBu-8ZfsE81A3O_3Lixp9JHNF_Hy5um26gHm4D4IFiLgwsuoPSYsoqJ2",
      "refunded": false,
      "review": null,
      "shipping": null,
      "source": null,
      "source_transfer": null,
      "statement_descriptor": null,
      "statement_descriptor_suffix": null,
      "status": "succeeded",
      "transfer_data": null,
      "transfer_group": null
    }
  },
  "id": "evt_3Qz7DEBy52mpTfqU11yXtOyX",
  "livemode": false,
  "object": "event",
  "pending_webhooks": 2,
  "request": {
    "id": null,
    "idempotency_key": null
  },
  "type": "charge.updated"
}
[2m2025-03-05T10:57:36.862+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Using 'application/xml', given [application/xml, */*;q=0.5] and supported [text/plain, */*, application/json, application/*+json]
[2m2025-03-05T10:57:36.862+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.w.s.m.m.a.HttpEntityMethodProcessor [0;39m [2m:[0;39m Writing ["Success"]
[2m2025-03-05T10:57:36.863+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [io-8080-exec-10] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:36.958+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/css/style.css", parameters={}
[2m2025-03-05T10:57:36.961+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m GET "/images/logo.png", parameters={}
[2m2025-03-05T10:57:36.961+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:36.961+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.w.s.handler.SimpleUrlHandlerMapping [0;39m [2m:[0;39m Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
[2m2025-03-05T10:57:36.963+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-3] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T10:57:36.967+09:00[0;39m [32mDEBUG[0;39m [35m17496[0;39m [2m--- [samuraitravel] [nio-8080-exec-1] [0;39m[36mo.s.web.servlet.DispatcherServlet       [0;39m [2m:[0;39m Completed 200 OK
[2m2025-03-05T11:47:34.354+09:00[0;39m [33m WARN[0;39m [35m17496[0;39m [2m--- [samuraitravel] [l-4 housekeeper] [0;39m[36mcom.zaxxer.hikari.pool.HikariPool       [0;39m [2m:[0;39m HikariPool-4 - Thread starvation or clock leap detected (housekeeper delta=49m29s824ms258s600ns).
